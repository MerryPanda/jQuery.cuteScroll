(function(a){a.fn.cuteScroll=function(c){var b=a.extend({},a.fn.cuteScroll.defaults,c);b.scrollerPositionCss=(b.scrollerPosition==="left")?{left:b.scrollerIndent}:{right:b.scrollerIndent};b.railPositionCss=b.railIndent?((b.scrollerPosition==="left")?{left:b.railIndent}:{right:b.railIndent}):null;this.each(function(){var d={generator:new function(){this.id=function(v){return Date.now().toString(36)+"-"+Math.random().toString(36).substr(2,8)}}};var o={touch:function(){var v={early:null,current:null};var x={y:{early:null,last:null,current:null},delta:null,};function w(){var y=v.current-v.early;if(y>b.touchSwipeTimeAdjustmentThreshold){v.early+=y/2;x.y.early+=(x.y.current-x.y.early)/2}}this.velocityGet=function(){var A=x.y.current-x.y.early;var z=v.current-v.early;return A/z};this.moveDeltaGetAndShift=function(){x.delta=x.y.last-x.y.current;x.y.last=x.y.current;return x.delta};this.distanceGet=function(){return Math.abs(x.y.current-x.y.early)};this.getDelta=function(){return x.delta};this.move=function(z){x.y.current=z;v.current=new Date().getTime();w()};this.start=function(z){x.y.early=x.y.last=z;v.early=new Date().getTime()}},state:function(){var w=false;var v=true;this.isBusy=function(){return w};this.setIdle=function(){w=false};this.setBusy=function(){w=true};this.isEnabled=function(){return v};this.setToEnabled=function(){v=true};this.setToDisabled=function(){v=false}},};var h=new function(){this.invoke=function(v){this.el=a(v)};this.cssSet=function(){this.el.css({overflow:"hidden",width:b.width,height:b.height,}).addClass(b.addClass)};this.cssDel=function(){this.el.css({overflow:"",width:"",height:"",}).removeClass(b.removeClass)};this.isProcessed=function(){if(this.el.parent().hasClass(b.wrapperClass)){return true}else{return false}};this.applyBarPercentage=function(){var v=this.getMaxOffset();var w=r.percentage*v;this.el.scrollTop(w)};this.shouldItBeScrolled=function(){return this.height()>f.height()?true:false};this.isAtEdge=function(){return(r.percentage===0||r.percentage===1)?true:false};this.getMaxOffset=function(){return Math.abs(f.height()-this.height())};this.getVisibleProportion=function(){return Math.abs(f.height()/this.height())};this.height=function(){return this.el[0].scrollHeight}};var g=new function(){this.invoke=function(){this.el=a(window)}};var u=new function(){this.invoke=function(){this.el=a(document)}};var k=new function(){this.create=function(){this.el=a("<div>").addClass(b.wrapperClass).css({display:"block",position:"relative",overflow:"hidden",width:b.width,height:b.height,})}};var f=new function(){this.create=function(){this.el=a("<div>").addClass(b.railClass).css({width:b.railWidth||b.scrollerWidth,height:b.height?b.height:"100%",position:"absolute",top:0,display:(b.scrollerAlwaysVisible&&b.railVisible)?"block":"none",borderRadius:b.railBorderRadius,background:b.railColor,opacity:b.railOpacity,zIndex:100,}).css(b.railPositionCss?b.railPositionCss:b.scrollerPositionCss)};this.obtain=function(){this.el=h.el.siblings("."+b.railClass)};this.height=function(){return this.el.outerHeight(true)}};var r=new function(){var v=this;this.applyProportionalHeight=function(){if(!b.barHeight){this.el.css("height",h.getVisibleProportion()*f.height())}};this.create=function(){this.el=a("<div>").addClass(b.barClass).css({width:b.barWidth||b.scrollerWidth,minHeight:b.barMinHeight,maxHeight:b.barMaxHeight,height:b.barHeight,position:"absolute",top:0,opacity:b.barOpacity,display:b.scrollerAlwaysVisible?"block":"none",background:b.barColor,borderRadius:b.barBorderRadius,zIndex:110,}).css(b.scrollerPositionCss)};this.obtain=function(){this.el=h.el.siblings("."+b.barClass)};this.getMaxOffset=function(){return f.height()-this.height()};this.height=function(){return this.el.outerHeight()};this.move=function(A){var w=this.getMaxOffset();var z=this.el.position().top+A;if(z>w){var x=w}else{if(z<0){var x=0}else{var x=z}}this.el.css("top",x);this.percentage=x/w};this.jumpToTop=function(){this.el.css("top",0);this.percentage=0};this.jumpToBottom=function(){this.el.css("top",this.getMaxOffset());this.percentage=1};this.getWheelIteration=function(){return b.wheelStep/h.getMaxOffset()*f.height()};this.getTouchIteration=function(w){return b.touchMoveFactor*w/h.getMaxOffset()*f.height()}};var s=new function(){var w=d.generator.id();var C=this;var z;var x={};var v=new o.state;function y(){v.setToDisabled();C.jumpToTop();f.el.hide();r.el.hide()}function A(){v.setToEnabled();C.canBeHiddenSurely();r.applyProportionalHeight();C.jumpToTop();if(b.onContentChangeShow){E()}}function D(F){if(v.isEnabled()){E();r.move(F);h.applyBarPercentage()}}this.id=function(){return w};this.shouldKeepVisible=function(){for(var F in x){return true}return false};this.shouldBeShown=function(F){x[F]=true;E()};this.canBeHidden=function(F){delete x[F]};this.canBeHiddenSurely=function(F){x={}};function B(){if(!b.scrollerAlwaysVisible){z=setTimeout(function(){if(!C.shouldKeepVisible()){f.el.fadeOut(b.scrollerFadeOutSpeed);r.el.fadeOut(b.scrollerFadeOutSpeed)}},b.scrollerHideDelay)}}function E(){if(v.isEnabled()){clearTimeout(z);if(b.railVisible){f.el.stop(true).fadeIn(b.scrollerFadeInSpeed)}r.el.stop(true).fadeIn(b.scrollerFadeInSpeed);B()}}this.scrollByScrollerBar=function(F){D(F)};this.scrollByWheel=function(F){D(F*r.getWheelIteration())};this.scrollByTouchMove=function(F){D(r.getTouchIteration(F))};this.scrollByTouchSwipe=function(H,K){if(Math.abs(H)>b.touchSwipeVelocityThreshold&&Math.abs(K)>b.touchSwipeDistanceThreshold){var G=Math.abs(r.getTouchIteration(K)*H*b.touchSwipeStrengthFactor);var J=-Math.sign(H);var I=function(){if(G>b.touchSwipeIterationMinDistance){var L=G*J;G-=Math.abs(L)*b.touchSwipeFadingFactor;D(L);setTimeout(I,b.touchSwipeIterationTimeout)}};var F=setTimeout(I,100)}};this.jumpToTop=function(){r.jumpToTop();h.applyBarPercentage()};this.jumpToBottom=function(){r.jumpToBottom();h.applyBarPercentage()};this.onCanvasChange=function(){if(!h.shouldItBeScrolled()&&!b.scrollerAlwaysVisible){y()}else{A()}}};var j=new function(){this.removeCss=function(){if(b.removeCss){for(var w in b.removeCss){var x=jQuery(w);for(var v in b.removeCss[w]){x.css(v,"")}}}};this.remove=function(){if(b.remove){p.remove();r.el.remove();f.el.remove();h.el.unwrap();h.cssDel();this.removeCss()}};this.jumpToTop=function(){if(b.jumpToTop){s.jumpToTop()}};this.jumpToBottom=function(){if(b.jumpToBottom){s.jumpToBottom()}};this.alert=function(){if(b.alert){alert(b.alert)}}};var p=new function(){this.remove=function(){g.el.off("resize.cuteScroll");r.el.off("mouseenter mouseleave mousedown.cuteScroll");f.el.off("mouseenter mouseleave");h.el.off("mouseenter mouseleave wheel.cuteScroll mousewheel.cuteScroll touchstart.cuteScroll touchmove.cuteScroll touchend.cuteScroll")};this.onHover=function(){f.el.hover(function(){s.shouldBeShown("rail")},function(){s.canBeHidden("rail")});r.el.hover(function(){s.shouldBeShown("bar")},function(){s.canBeHidden("bar")});h.el.hover(function(){s.shouldBeShown("canvas")},function(){s.canBeHidden("canvas")})};this.onScrollerBarDrag=function(){if(b.barDraggable){r.el.on("mousedown.cuteScroll",function(v){u.el.on("mousemove.cuteScroll",function(w){s.scrollByScrollerBar(w.pageY-v.pageY);v.pageY=w.pageY});u.el.on("mouseup.cuteScroll",function(w){u.el.off("mousemove.cuteScroll");u.el.off("mouseup.cuteScroll")});return false})}};this.onWheelScroll=function(){h.el.on("wheel.cuteScroll mousewheel.cuteScroll",function(w){var v=Math.sign(w.originalEvent.deltaY);if(v!==0){s.scrollByWheel(v)}if(!h.isAtEdge()||!b.pageScroll){w.preventDefault()}})};this.onContentChange=function(){var v=new MutationObserver(function(w){if(b.onContentChange){b.onContentChange(h.el)}s.onCanvasChange()});v.observe(h.el.get(0),{childList:true,subtree:true})};this.onResize=function(){g.el.on("resize.cuteScroll",function(){s.onCanvasChange()})};this.onTouch=function(){var v;h.el.on("touchstart.cuteScroll",function(w){s.shouldBeShown("touch");v=new o.touch;v.start(w.originalEvent.touches[0].pageY)});h.el.on("touchmove.cuteScroll",function(w){v.move(w.originalEvent.touches[0].pageY);s.scrollByTouchMove(v.moveDeltaGetAndShift());w.preventDefault()});h.el.on("touchend.cuteScroll",function(w){s.canBeHidden("touch");s.scrollByTouchSwipe(v.velocityGet(),v.getDelta())})}};function l(){h.el.wrap(k.el);h.el.parent().append(r.el);h.el.parent().append(f.el)}function m(){f.obtain();r.obtain()}function i(){if(b.addCss){for(var v in b.addCss){jQuery(v).css(b.addCss[v])}}}function n(){k.create();f.create();r.create();h.cssSet();i()}function t(v){g.invoke();u.invoke();h.invoke(v)}function e(){n();l();s.onCanvasChange();p.onHover();p.onScrollerBarDrag();p.onWheelScroll();p.onContentChange();p.onResize();p.onTouch()}function q(v){t(v);if(h.isProcessed()){m()}else{e()}j.jumpToTop();j.jumpToBottom();j.alert();j.remove()}q(this)});return this};a.fn.cuteScroll.defaults={barColor:"black",barHeight:false,barWidth:false,barMinHeight:"6rem",barMaxHeight:"auto",barOpacity:0.4,barBorderRadius:"1rem",barDraggable:true,barClass:"cuteScroll-bar",railColor:"black",railWidth:false,railIndent:false,railOpacity:0.1,railBorderRadius:"1rem",railVisible:false,railClass:"cuteScroll-rail",scrollerIndent:"0.1rem",scrollerPosition:"right",scrollerWidth:"0.4rem",scrollerAlwaysVisible:false,scrollerHideDelay:1000,scrollerFadeOutSpeed:"slow",scrollerFadeInSpeed:"fast",pageScroll:true,wheelStep:120,touchSwipeStrengthFactor:1.25,touchSwipeFadingFactor:0.075,touchSwipeVelocityThreshold:0.5,touchSwipeDistanceThreshold:10,touchSwipeTimeAdjustmentThreshold:500,touchSwipeIterationMinDistance:0.2,touchSwipeIterationTimeout:5,touchMoveFactor:1.1,height:"20rem",width:"100%",addClass:false,removeClass:false,addCss:false,removeCss:false,wrapperClass:"cuteScroll-wrapper",onContentChange:false,onContentChangeShow:true,remove:false,jumpToTop:false,jumpToBottom:false,alert:false,}})(jQuery);